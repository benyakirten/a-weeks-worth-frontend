(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[478],{3478:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AuthModule:()=>P});var o=n(8583),r=n(665),i=n(4466),a=n(5666),s=n(3035),l=n(9810),d=n(2459),u=n(3018),c=n(1706),g=n(2479),m=n(3688),p=n(42),h=n(7611),f=n(8424),b=n(6445);function v(e,t){if(1&e&&(u.TgZ(0,"app-error-display"),u._uU(1),u.qZA()),2&e){const e=u.oxw();u.xp6(1),u.hij(" ",e.error," ")}}function M(e,t){if(1&e&&(u.TgZ(0,"div",8),u._UZ(1,"input",20),u.TgZ(2,"label",21),u._uU(3,"Username"),u.qZA(),u.qZA()),2&e){const e=u.oxw();u.Q6J("@input",void 0),u.xp6(1),u.Q6J("required",!e.loginMode)}}function Z(e,t){if(1&e&&(u.TgZ(0,"div",8),u._UZ(1,"input",22),u.TgZ(2,"label",23),u._uU(3,"Confirm Password"),u.qZA(),u.qZA()),2&e){const e=u.oxw();u.Q6J("@input",void 0),u.xp6(1),u.Q6J("required",!e.loginMode)}}function w(e,t){1&e&&(u.TgZ(0,"div",24),u._UZ(1,"app-loading",25),u.qZA())}function _(e,t){if(1&e&&u._UZ(0,"app-default-display-box",26),2&e){const e=u.oxw();u.Q6J("rules",e.rules)}}const y=[{path:"",pathMatch:"exact",component:(()=>{class e{constructor(e,t,n,o){this.route=e,this.router=t,this.authService=n,this.store=o,this.loading=!1,this.loginMode=!0,this.rules=["All fields must be filled out","Email and username must be at least 6 characters","Username must be no longer than 150 letters","Username must only be letters, numbers or the following symbols: _@+-. ","Email must be an email address","Email and username must be unique","Password must be at least 8 characters long","Password must contain letters","Passwords must match","Password must not be too common (easy to guess)"]}ngOnInit(){this.route.queryParams.subscribe(e=>this.returnRoute=e.returnUrl)}alternateMode(){this.loginMode=!this.loginMode}onSubmit(e){e.valid?this.loginMode||e.form.value.password===e.form.value.password2?(this.error=void 0,this.loading=!0,this.mutationSubscription=this.loginMode?this.authService.login(e.form.value.email,e.form.value.password).subscribe(({data:e})=>{this.handleSubscriptionData(null==e?void 0:e.tokenAuth)}):this.authService.register(e.form.value.email,e.form.value.username,e.form.value.password,e.form.value.password2).subscribe(({data:t,errors:n})=>{n?this.error=n[0].message:t&&this.handleSubscriptionData(Object.assign(Object.assign({},null==t?void 0:t.register),{user:{username:e.form.value.username,email:e.form.value.email,verified:!1}}))})):this.error="Passwords do not match":this.error="Form is invalid"}handleSubscriptionData(e){if(!e)return this.error="Something went wrong. Please try again.",void(this.loading=!1);this.loading=!1,e.errors&&(this.error=this.authService.handleError(e.errors)),e.success&&(this.store.dispatch(l.x4({user:new d.n(e.user.email,e.user.username,e.token,e.refreshToken,e.user.verified)})),this.returnRoute?this.router.navigateByUrl(this.returnRoute):this.router.navigate(["/the-week"]))}ngOnDestroy(){var e;null===(e=this.mutationSubscription)||void 0===e||e.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(a.gz),u.Y36(a.F0),u.Y36(c.e),u.Y36(g.yh))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-auth"]],decls:34,vars:13,consts:[[1,"form-title"],["width","35rem"],[1,"mode-buttons"],[3,"click"],[1,"body"],[3,"ngSubmit"],["f","ngForm"],[4,"ngIf"],[1,"control-group"],["type","email","id","email","name","email","placeholder"," ","ngModel","","required","","email","","autofocus",""],["for","email"],["class","control-group",4,"ngIf"],["type","password","id","password","name","password","placeholder"," ","ngModel","","required","","minlength","8"],["for","password"],[1,"buttons"],["type","submit",3,"disabled","padding"],["class","loading",4,"ngIf"],["type","button","padding","1.5rem 3rem",3,"click"],[1,"display-box"],["headline","To create an account:",3,"rules",4,"ngIf"],["type","text","id","username","name","username","placeholder"," ","ngModel","","minlength","6",3,"required"],["for","username"],["type","password","id","password2","name","password2","placeholder"," ","ngModel","","minlength","8",3,"required"],["for","password2"],[1,"loading"],["size","2.5rem"],["headline","To create an account:",3,"rules"]],template:function(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"article"),u.TgZ(1,"div",0),u.TgZ(2,"h2"),u.TgZ(3,"span"),u._uU(4,"Login or Register"),u.qZA(),u.TgZ(5,"app-default-hover-toolbar",1),u._uU(6," Switch between the two modes by clicking to the right or the button at the bottom labeled 'I need to...' "),u.qZA(),u.qZA(),u.TgZ(7,"div",2),u.TgZ(8,"button",3),u.NdJ("click",function(){return t.loginMode?null:t.alternateMode()}),u._uU(9,"Login"),u.qZA(),u.TgZ(10,"button",3),u.NdJ("click",function(){return t.loginMode?t.alternateMode():null}),u._uU(11,"Register"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(12,"div",4),u.TgZ(13,"form",5,6),u.NdJ("ngSubmit",function(){u.CHM(e);const n=u.MAs(14);return t.onSubmit(n)}),u.YNc(15,v,2,1,"app-error-display",7),u.TgZ(16,"div",8),u._UZ(17,"input",9),u.TgZ(18,"label",10),u._uU(19,"Email"),u.qZA(),u.qZA(),u.YNc(20,M,4,2,"div",11),u.TgZ(21,"div",8),u._UZ(22,"input",12),u.TgZ(23,"label",13),u._uU(24,"Password"),u.qZA(),u.qZA(),u.YNc(25,Z,4,2,"div",11),u.TgZ(26,"div",14),u.TgZ(27,"app-button",15),u.YNc(28,w,2,0,"div",16),u._uU(29),u.qZA(),u.TgZ(30,"app-button",17),u.NdJ("click",function(){return t.alternateMode()}),u._uU(31),u.qZA(),u.qZA(),u.qZA(),u.TgZ(32,"div",18),u.YNc(33,_,1,1,"app-default-display-box",19),u.qZA(),u.qZA(),u.qZA()}if(2&e){const e=u.MAs(14);u.xp6(8),u.ekj("active",t.loginMode),u.xp6(2),u.ekj("active",!t.loginMode),u.xp6(5),u.Q6J("ngIf",t.error),u.xp6(5),u.Q6J("ngIf",!t.loginMode),u.xp6(5),u.Q6J("ngIf",!t.loginMode),u.xp6(2),u.Q6J("disabled",t.loading||!e.valid||!t.loginMode&&e.form.value.password!==e.form.value.password2)("padding",t.loading?"1.25rem 2rem":"1.5rem 3rem"),u.xp6(1),u.Q6J("ngIf",t.loading),u.xp6(1),u.hij(" ",t.loading?"":"Submit"," "),u.xp6(2),u.hij(" I need to ",t.loginMode?"register":"login"," instead "),u.xp6(2),u.Q6J("ngIf",!t.loginMode)}},directives:[m.E,r._Y,r.JL,r.F,o.O5,r.Fj,r.JJ,r.On,r.Q7,r.on,r.wO,p.r,h.n,f.N,b.g],styles:["article[_ngcontent-%COMP%]{position:relative}article[_ngcontent-%COMP%]   .form-title[_ngcontent-%COMP%]{border-bottom:1px solid #000}article[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{display:flex}@media only screen and (max-width:56.25em){article[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-direction:column-reverse}}article[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:50%;position:relative;padding:2rem}article[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{padding:1rem 2rem;margin:2rem 1rem;width:40rem;background-color:#ff4d6db3;border:1px solid #343a40}article[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;margin:1rem}article[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}article[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:first-child{margin-right:4rem}"],data:{animation:[(0,s.Ro)("input")]}}),e})(),canActivate:[(()=>{class e{canActivate(){const e=localStorage.getItem("AWW_expiration");return!e||Date.now()>+e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=u.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()]}];let A=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[a.Bz.forChild(y)],a.Bz]}),e})(),P=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[o.ez,r.u5,i.m,A]]}),e})()}}]);